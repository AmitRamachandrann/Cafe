name: "CodeQL Analysis"

on:
  push:
    branches:
      - test  

jobs:
  analyze:
    runs-on: ubuntu-latest  # Define the runner environment

    steps:
    # Step 1: Check out the repository
    - name: Checkout repository
      uses: actions/checkout@v3

    # Step 2: Set up CodeQL
    - name: Set up CodeQL
      uses: github/codeql-action/setup-codeql@v2

    # Step 3: Initialize CodeQL databases
    - name: Initialize CodeQL database
      run: |
        # Initialize CodeQL for supported languages (example: JavaScript, Python)
        # You can change the language based on your repo's codebase
        codeql database create codeql-db --language=python

    # Step 4: Perform the analysis
    - name: Perform CodeQL Analysis
      run: |
        # Run CodeQL analysis on the repository
        codeql analyze codeql-db --format=sarif-latest --output=codeql-sarif-results.sarif

    # Step 5: Upload the SARIF results
    - name: Upload CodeQL analysis results
      uses: github/codeql-action/upload-sarif@v2
      with:
        sarif_file: codeql-sarif-results.sarif

    # Optional Step: Upload code coverage or other relevant information
    # - name: Upload coverage
    #   uses: actions/upload-artifact@v3
    #   with:
    #     name: codeql-sarif-results
    #     path: codeql-sarif-results.sarif
